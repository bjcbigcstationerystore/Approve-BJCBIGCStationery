<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Approval ‚Ä¢ BJC Big C Stationery Store</title>

  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --emerald-700:#047857;
      --emerald-600:#059669;
      --emerald-500:#10b981;
      --slate-700:#334155;
      --slate-600:#475569;
      --slate-500:#64748b;
      --slate-200:#e2e8f0;
      --brand:#2563eb; /* ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°/‡πÅ‡∏ó‡πá‡∏ö‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö‡πÉ‡∏ô‡∏†‡∏≤‡∏û */
    }
    html,body{
      height:100%;
      margin:0;
      font-family:'Prompt',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:
        radial-gradient(1000px 400px at 20% -10%, rgba(5,150,105,.25) 0%, transparent 70%),
        radial-gradient(1000px 400px at 80% 110%, rgba(4,120,87,.22) 0%, transparent 70%),
        linear-gradient(180deg, var(--emerald-500) 0%, var(--emerald-600) 45%, var(--emerald-700) 100%);
      color:#0f172a;
    }
    .container-card{
      background: #f8fafc;
      border:1px solid rgba(15,23,42,.06);
      border-radius:18px;
      box-shadow:0 14px 36px rgba(2,8,23,.14);
    }
    .chip{
      display:inline-flex;align-items:center;gap:.5rem;
      padding:.55rem .9rem;border-radius:999px;font-weight:600;font-size:.9rem;
      background:#eef2ff;color:#1d4ed8;border:1px solid rgba(29,78,216,.15);
      cursor:pointer; user-select:none;
    }
    .chip.active{
      background:#1d4ed8;color:#fff; box-shadow:0 6px 18px rgba(29,78,216,.28);
    }
    .badge{
      display:inline-flex;align-items:center;gap:.4rem;
      padding:.35rem .6rem;border-radius:999px;font-weight:600;font-size:.82rem;
      border:1px solid transparent;
    }
    .badge.green{ background:#dcfce7; color:#166534; border-color:#86efac; }
    .badge.yellow{ background:#fef9c3; color:#854d0e; border-color:#fde68a; }
    .badge.red{ background:#fee2e2; color:#991b1b; border-color:#fecaca; }
    .btn-primary{
      background:#1d4ed8;color:#fff;font-weight:700;padding:.55rem 1rem;border-radius:12px;
      border:1px solid rgba(29,78,216,.25);
      box-shadow:0 8px 22px rgba(29,78,216,.25);
    }
    table{ width:100%; border-collapse:separate; border-spacing:0; }
    thead th{
      text-align:left; font-weight:700; color:var(--slate-600);
      border-bottom:1px solid #e5e7eb; padding:.9rem 1rem; background:#fff;
    }
    tbody td{
      padding:1rem; border-bottom:1px solid #e5e7eb; background:#fff; color:#0f172a;
    }
    .title-underline{
      position:relative; display:inline-block; padding-bottom:.35rem;
    }
    .title-underline::after{
      content:""; position:absolute; left:0; right:0; bottom:0; height:4px;
      border-radius:999px; background:#93c5fd;
      width:70%; margin:auto;
    }
  </style>
</head>
<body>
  <div class="min-h-screen w-full px-4 py-10">
    <!-- ‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏ç‡πà -->
    <h1 class="text-center text-3xl md:text-4xl font-extrabold tracking-wide text-slate-900">
      <span class="title-underline">APPROVAL STATIONERY STORE</span>
    </h1>

    <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå -->
    <div class="container-card max-w-6xl mx-auto mt-7 p-5 md:p-7">
      <div class="flex flex-col md:flex-row items-center gap-4 md:gap-8">
        <!-- avatar -->
        <div class="h-20 w-20 rounded-full bg-slate-200 flex items-center justify-center text-3xl">
          üë§
        </div>
        <!-- 3 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 w-full">
          <div>
            <div class="text-slate-500">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
            <div id="empName" class="text-xl font-bold">‚Äî</div>
          </div>
          <div>
            <div class="text-slate-500">‡πÅ‡∏ú‡∏ô‡∏Å Cost Center</div>
            <div id="empCostCenter" class="text-xl font-semibold">‚Äî</div>
          </div>
          <div>
            <div class="text-slate-500">Email</div>
            <a id="empEmail" href="#" class="text-xl font-semibold text-blue-700 underline underline-offset-4">‚Äî</a>
          </div>
        </div>
      </div>
    </div>

    <!-- ‡∏ä‡∏¥‡∏û‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ + ‡∏õ‡∏∏‡πà‡∏° -->
    <div class="container-card max-w-6xl mx-auto mt-6 p-4 md:p-5">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <div class="flex flex-wrap gap-2">
          <span class="chip active">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (8)</span>
          <span class="chip">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ (3)</span>
          <span class="chip">‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ (3)</span>
          <span class="chip">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (1)</span>
          <span class="chip">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò (1)</span>
        </div>
        <div class="flex gap-2">
          <button class="btn-primary" type="button">üìÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</button>
          <button class="btn-primary" type="button">üî• ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô</button>
        </div>
      </div>
    </div>

    <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ -->
    <div class="container-card max-w-6xl mx-auto mt-6 overflow-x-auto">
      <table>
        <thead>
          <tr>
            <th class="min-w-[160px]">Request Number</th>
            <th class="min-w-[180px]">‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡πÄ‡∏ö‡∏¥‡∏Å</th>
            <th class="min-w-[130px]">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠</th>
            <th class="min-w-[340px]">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏ä‡∏¥‡πâ‡∏ô)</th>
            <th class="min-w-[110px]">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
            <th class="min-w-[120px]">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
            <th class="min-w-[130px] text-right">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
          </tr>
        </thead>
        <tbody id="reqBody">
          <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (mock) ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á -->
          <tr>
            <td><a href="#" class="text-blue-700 font-semibold underline">REQ-ST-2024-001</a></td>
            <td>‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡πÉ‡∏à‡∏î‡∏µ</td>
            <td>2024-01-15</td>
            <td>‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤, ‡∏î‡∏¥‡∏ô‡∏™‡∏≠, ‡∏¢‡∏≤‡∏á‡∏•‡∏ö (15 ‡∏ä‡∏¥‡πâ‡∏ô)</td>
            <td class="font-bold">450 ‡∏ö‡∏≤‡∏ó</td>
            <td><span class="badge green">‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span></td>
            <td class="text-right"><button class="btn-primary">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button></td>
          </tr>
          <tr>
            <td><a href="#" class="text-blue-700 font-semibold underline">REQ-ST-2024-002</a></td>
            <td>‡∏ô‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡∏£‡∏±‡∏Å‡∏á‡∏≤‡∏ô</td>
            <td>2024-01-16</td>
            <td>‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4, ‡πÅ‡∏ü‡πâ‡∏° (25 ‡∏ä‡∏¥‡πâ‡∏ô)</td>
            <td class="font-bold">320 ‡∏ö‡∏≤‡∏ó</td>
            <td><span class="badge yellow">‚è≥ ‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span></td>
            <td class="text-right"><button class="btn-primary">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button></td>
          </tr>
          <tr>
            <td><a href="#" class="text-blue-700 font-semibold underline">REQ-ST-2024-004</a></td>
            <td>‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á</td>
            <td>2024-01-18</td>
            <td>‡∏™‡∏°‡∏∏‡∏î‡πÇ‡∏ô‡πâ‡∏ï, ‡πÑ‡∏™‡πâ‡∏î‡∏¥‡∏ô‡∏™‡∏≠ (12 ‡∏ä‡∏¥‡πâ‡∏ô)</td>
            <td class="font-bold">180 ‡∏ö‡∏≤‡∏ó</td>
            <td><span class="badge red">‚ùå ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</span></td>
            <td class="text-right"><button class="btn-primary">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // ====== ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ URL ‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ (‡∏≠‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å) ======
    const API_URL = "https://script.google.com/macros/s/AKfycbyUDaiiIRN2_OfWgqiusRYivGmed5Gj0K8_Ry5ogXlNRx854YHvsWizjr83jHQkxcO4Cw/exec";

    // ‡∏≠‡πà‡∏≤‡∏ô empId ‡∏à‡∏≤‡∏Å query
    const params = new URLSearchParams(location.search);
    const empId = params.get("empId");

    if (!empId) {
      // ‡πÑ‡∏°‡πà‡∏°‡∏µ empId ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
      location.replace("./");
    } else {
      // ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
      loadProfile(empId);
    }

    async function loadProfile(id){
      try{
        const url = `${API_URL}?action=profile&empId=${encodeURIComponent(id)}`;
        const res = await fetch(url, {cache:'no-store'});
        const data = await res.json();

        if (!data.success || !data.exists) {
          alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô/‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á");
          location.replace("./");
          return;
        }

        // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡πå‡∏î
        document.getElementById("empName").textContent = data.profile.name || "‚Äî";
        document.getElementById("empCostCenter").textContent = data.profile.costCenter || "‚Äî";
        const emailEl = document.getElementById("empEmail");
        if (data.profile.email){
          emailEl.textContent = data.profile.email;
          emailEl.href = `mailto:${data.profile.email}`;
        }else{
          emailEl.textContent = "‚Äî";
          emailEl.removeAttribute("href");
        }

        // (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á) ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ API ‡∏Ñ‡∏∑‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠ ‡∏Å‡πá‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà tbody ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        // renderRequests(data.requests)
      }catch(err){
        console.error(err);
        alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
        location.replace("./");
      }
    }
  </script>
</body>
</html>

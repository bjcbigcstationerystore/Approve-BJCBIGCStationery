<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BJC Big C Stationery Store</title>

  <!-- Font + Tailwind -->
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --emerald-700:#047857;
      --emerald-600:#059669;
      --emerald-500:#10b981;
    }
    html,body{
      height:100%;
      margin:0;
      font-family:'Prompt',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:
        radial-gradient(1000px 400px at 20% -10%, rgba(5,150,105,.25) 0%, transparent 70%),
        radial-gradient(1000px 400px at 80% 110%, rgba(4,120,87,.22) 0%, transparent 70%),
        linear-gradient(180deg, var(--emerald-500) 0%, var(--emerald-600) 45%, var(--emerald-700) 100%);
      color:#0f172a;
    }

    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ Verify */
    .verify-box{
      position:relative;
      background:#ffffff;
      border:1px solid rgba(15,23,42,.06);
      border-radius:18px;
      box-shadow:0 20px 42px rgba(2,8,23,.12);
      padding:70px 40px;
      text-align:center;
      width:100%;
      max-width:580px;
      margin:auto;
    }
    @media (max-width:480px){
      .verify-box{ padding:40px 24px; max-width:90vw; }
    }
    .verify-logo{ margin:-40px auto 35px; display:flex; align-items:center; justify-content:center; }
    .verify-logo img{ height:64px; width:auto; }
    @media (max-width:480px){
      .verify-logo{ margin:-10px auto 20px; }
      .verify-logo img{ height:52px; }
    }
    .verify-title{ font-weight:700; font-size:1.7rem; letter-spacing:.01em; text-transform:uppercase; margin-bottom:.25rem; }
    .verify-subtitle{ display:inline-flex; align-items:center; justify-content:center; gap:10px; font-size:1.125rem; color:#334155; font-weight:700; margin:.15rem 0 1.2rem; }
    .verify-desc{ font-size:.95rem; color:#64748b; text-align:left; margin:.15rem 0 .25rem; }
    .input-wrapper{ position:relative; width:100%; margin-top:.1rem; }
    .input-icon{ position:absolute; left:14px; top:50%; transform:translateY(-50%); width:24px; height:24px; opacity:.9; pointer-events:none; }
    .verify-input{
      width:100%; padding:12px 14px 12px 48px; background:#fff; border:1.5px solid #cbd5e1; border-radius:10px;
      font-size:1rem; color:#0f172a; transition:all .2s ease-in-out; margin-top:.25rem;
    }
    .verify-input::placeholder{ color:#94a3b8; }
    .verify-input:focus{ outline:none; border-color:#10b981; box-shadow:0 0 0 3px rgba(16,185,129,.18); }
    .verify-button{
      width:100%; margin-top:1.4rem; min-height:56px; border:none; border-radius:14px; font-weight:600; font-size:1.05rem; color:#fff;
      background:linear-gradient(135deg,#10b981,#059669); box-shadow:0 12px 26px rgba(16,185,129,.28); cursor:pointer;
      transition:transform .15s ease, background .15s ease, box-shadow .15s ease;
    }
    .verify-button:hover{
      background:linear-gradient(135deg,#059669,#047857); transform:translateY(-1px); box-shadow:0 14px 30px rgba(16,185,129,.34);
    }

    /* ‡∏´‡∏ô‡πâ‡∏≤ 2 ‚Äì ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô */
    .profile-card{
      background:#fff; border:1px solid rgba(15,23,42,.06); border-radius:18px;
      box-shadow:0 20px 42px rgba(2,8,23,.12);
    }
    .field-label{ font-size:.85rem; color:#64748b; margin-bottom:.25rem; }
    .field-value{ font-size:1.05rem; color:#0f172a; }
    .avatar{
      width:72px; height:72px; border-radius:9999px; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(135deg,#6366f1,#3b82f6); color:#fff; font-weight:700; font-size:1.4rem;
    }
  </style>
</head>

<body>
  <!-- PAGE 1: Verify -->
  <section id="page-verify" class="min-h-screen w-full flex items-center justify-center px-4 py-10">
    <div class="verify-box">
      <div class="verify-logo">
        <img src="https://i.postimg.cc/B6wpk3yh/cropped-Logo-BJC-Big-C-2021-2048x606.png" alt="BJC Big C Logo" loading="lazy"
             onerror="this.src='https://via.placeholder.com/200x60?text=BJC+Big+C'">
      </div>

      <h1 class="verify-title">APPROVAL STATIONERY STORE</h1>
      <p class="verify-subtitle"><span aria-hidden="true">üè¢</span> ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</p>
      <p class="verify-desc">‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>

      <label for="employeeId" class="sr-only">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
      <div class="input-wrapper">
        <img src="https://i.postimg.cc/4NKdMhvp/id-card.png" alt="" class="input-icon">
        <input id="employeeId" type="text" class="verify-input" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô">
      </div>

      <button id="btnProceed" class="verify-button" type="button">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠</button>

      <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á error ‡πÄ‡∏•‡πá‡∏Å ‡πÜ -->
      <p id="errBox" class="mt-3 text-sm text-red-600 hidden">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
    </div>
  </section>

  <!-- PAGE 2: Profile -->
  <section id="page-profile" class="min-h-screen w-full px-4 py-10 hidden">
    <div class="max-w-6xl mx-auto space-y-6">
      <div class="text-center">
        <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">APPROVAL STATIONERY STORE</h1>
        <div class="mt-2 h-1 w-24 bg-blue-500 mx-auto rounded"></div>
      </div>

      <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
      <div class="profile-card p-6 md:p-8">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
          <!-- ‡∏ã‡πâ‡∏≤‡∏¢: avatar -->
          <div class="flex items-center gap-4">
            <div id="pfAvatar" class="avatar">üë§</div>
            <div>
              <div class="field-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
              <div id="pfName" class="field-value font-semibold">-</div>
            </div>
          </div>

          <!-- ‡∏Å‡∏•‡∏≤‡∏á: Division + Cost Center -->
          <div>
            <div class="field-label">‡πÅ‡∏ú‡∏ô‡∏Å Cost Center</div>
            <div id="pfDivisionCost" class="field-value">-</div>
          </div>

          <!-- ‡∏Ç‡∏ß‡∏≤: Email -->
          <div>
            <div class="field-label">Email</div>
            <a id="pfEmail" class="field-value text-blue-600 hover:underline" href="#" target="_blank">-</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
    // === ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheet ===
    const SHEET_ID   = '15Nzap1xe_qkcBoVskRTMG7o7Gb_zE8nTRm8rY3VeMmg';
    const SHEET_NAME = 'Master';

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô Google Visualization API (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Anyone with the link ‚Äì Viewer)
    async function fetchSheetRows() {
      const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&headers=1&sheet=${encodeURIComponent(SHEET_NAME)}`;
      const res = await fetch(url);
      const text = await res.text();

      // ‡∏ï‡∏±‡∏î wrapper ‡∏Ç‡∏≠‡∏á GViz ‡∏≠‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ JSON
      const json = JSON.parse(text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1));
      const cols = json.table.cols.map(c => (c.label || '').trim());

      // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô array ‡∏Ç‡∏≠‡∏á object ‡πÇ‡∏î‡∏¢‡∏≠‡∏¥‡∏á label ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
      const rows = (json.table.rows || []).map(r => {
        const obj = {};
        r.c.forEach((cell, idx) => {
          obj[cols[idx] || `col${idx}`] = cell ? cell.v : '';
        });
        return obj;
      });
      return rows;
    }

    // ‡∏´‡∏≤ record ‡∏ï‡∏≤‡∏° EmployeeID (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå F)
    function findByEmployeeId(rows, employeeId) {
      // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
      const idKeys = ['EmployeeID','EmpID','Employee Id','‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','F'];
      const nameKeys = ['Name','‡∏ä‡∏∑‡πà‡∏≠','G'];
      const emailKeys = ['Email','‡∏≠‡∏µ‡πÄ‡∏°‡∏•','H'];
      const divKeys = ['Division','‡∏ù‡πà‡∏≤‡∏¢','E'];
      const ccKeys = ['Cost Center','CostCenter','D'];

      const norm = s => String(s || '').trim().toLowerCase();

      for (const row of rows) {
        const idVal = idKeys.map(k => row[k]).find(v => v !== undefined);
        if (norm(idVal) === norm(employeeId)) {
          return {
            name:  nameKeys.map(k => row[k]).find(v => v !== undefined) || '',
            email: emailKeys.map(k => row[k]).find(v => v !== undefined) || '',
            division: divKeys.map(k => row[k]).find(v => v !== undefined) || '',
            costCenter: ccKeys.map(k => row[k]).find(v => v !== undefined) || ''
          };
        }
      }
      return null;
    }

    // ‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤
    function showPage(idToShow) {
      document.getElementById('page-verify').classList.toggle('hidden', idToShow !== 'verify');
      document.getElementById('page-profile').classList.toggle('hidden', idToShow !== 'profile');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // ‡∏Å‡∏î "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠"
    document.getElementById('btnProceed').addEventListener('click', async () => {
      const empId = document.getElementById('employeeId').value.trim();
      const err = document.getElementById('errBox');
      err.classList.add('hidden');

      if (!empId) {
        err.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';
        err.classList.remove('hidden');
        return;
      }

      try {
        const rows = await fetchSheetRows();
        const rec = findByEmployeeId(rows, empId);

        if (!rec) {
          err.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á';
          err.classList.remove('hidden');
          return;
        }

        // ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡∏´‡∏ô‡πâ‡∏≤ 2
        document.getElementById('pfName').textContent = rec.name || '-';
        document.getElementById('pfDivisionCost').textContent =
          `${rec.division || '-'} - ${rec.costCenter || '-'}`;

        const emailEl = document.getElementById('pfEmail');
        emailEl.textContent = rec.email || '-';
        emailEl.href = rec.email ? `mailto:${rec.email}` : '#';

        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï avatar ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏¢‡πà‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)
        const av = document.getElementById('pfAvatar');
        const initials = (rec.name || '').split(/\s+/).filter(Boolean).slice(0,2).map(s => s[0]).join('').toUpperCase();
        av.textContent = initials || 'üë§';

        showPage('profile');
      } catch (e) {
        console.error(e);
        err.textContent = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á';
        err.classList.remove('hidden');
      }
    });
  </script>
</body>
</html>
